login as: admuser
admuser@10.5.20.29's password:
Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-157-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Mon Oct  6 12:43:25 AM CEST 2025

  System load:  0.02               Processes:              306
  Usage of /:   13.4% of 96.37GB   Users logged in:        1
  Memory usage: 17%                IPv4 address for ens33: 10.5.20.29
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm

New release '24.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


Last login: Mon Oct  6 00:16:38 2025 from 10.5.34.33
admuser@admuser:~$ sudo -i
[sudo] password for admuser:
root@admuser:~# cd /opt/ceshtje-ligjore
root@admuser:/opt/ceshtje-ligjore# grep -n "async transferCases" server/storage.                                                                                                                                                             ts
root@admuser:/opt/ceshtje-ligjore# nano server/storage.ts
root@admuser:/opt/ceshtje-ligjore# npm run build
pm2 restart albpetrol-legal

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bu                                                                                                                                                             ndle --format=esm --outdir=dist

vite v5.4.20 building for production...
✓ 2411 modules transformed.
../dist/public/index.html                                         1.09 kB │ gzip                                                                                                                                                             :   0.62 kB
../dist/public/assets/Albpetrol.svg_1754604323425-C1lBmiZp.png   93.96 kB
../dist/public/assets/index-D1b5zML-.css                        159.05 kB │ gzip                                                                                                                                                             :  25.36 kB
../dist/public/assets/index-BaTynYKG.js                         870.49 kB │ gzip                                                                                                                                                             : 255.57 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollu                                                                                                                                                             pjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 3.86s

  dist/index.js  187.4kb

⚡ Done in 7ms
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 8    │ online    │ 0%       │ 17.0mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
root@admuser:/opt/ceshtje-ligjore# grep -n "async transferCases" server/storage.                                                                                                                                                             ts
656:  async transferCases(fromUserId: string, toUserId: string): Promise<{ count                                                                                                                                                             : number }> {
root@admuser:/opt/ceshtje-ligjore# # Check the latest logs (last 50 lines)
pm2 logs albpetrol-legal --lines 50

# OR if you want to see real-time logs while testing
pm2 logs albpetrol-legal
[TAILING] Tailing last 50 lines for [albpetrol-legal] process (change the value with --lines option)
/opt/ceshtje-ligjore/logs/err-0.log last 50 lines:
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup 51235c56-fdf2-46cb-bc8a-1af245ff5c77: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup c2fb1ac9-f691-41b1-aeee-9a657a22b6d9: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup fe6e12f6-4c49-4b9d-b633-e07d5984dbe9: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup e0d45223-168a-4141-a9e1-1fd3b44478a4: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup 3a8fd2db-3e60-4bc9-ac7e-3aa9484d309c: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]
0|albpetro | 2025-10-06T00:31:49: Warning: Corrupted tables field for backup 2e264b7d-8675-4256-8c91-bbf79ee70432: [
0|albpetro | 2025-10-06T00:31:49:   'data_entries',
0|albpetro | 2025-10-06T00:31:49:   'users',
0|albpetro | 2025-10-06T00:31:49:   'system_settings',
0|albpetro | 2025-10-06T00:31:49:   'sessions',
0|albpetro | 2025-10-06T00:31:49:   'database_checkpoints',
0|albpetro | 2025-10-06T00:31:49:   'system_backups'
0|albpetro | 2025-10-06T00:31:49: ]

/opt/ceshtje-ligjore/logs/out-0.log last 50 lines:
0|albpetro | 2025-10-06T00:48:01: Initializing court hearing notification scheduler...
0|albpetro | 2025-10-06T00:48:01: ⚠️ Scheduler already running, skipping duplicate start
0|albpetro | 2025-10-06T00:48:01: Scheduler instance created, starting automatic notifications...
0|albpetro | 2025-10-06T00:48:01: 12:48:01 AM [express] serving on port 5000
0|albpetro | 2025-10-06T00:48:06: [2025-10-05T22:48:06.179Z] 🚀 STARTUP CHECK TRIGGERED (5 seconds after start)
0|albpetro | 2025-10-06T00:48:06: [2025-10-05T22:48:06.181Z] === COURT HEARING CHECK STARTED ===
0|albpetro | 2025-10-06T00:48:06: Current time (GMT+1): 06.10.2025, 24:48
0|albpetro | 2025-10-06T00:48:06: Checking hearings within ≤26 hours: up to 07.10.2025, 24:48 [Albania Time]
0|albpetro | 2025-10-06T00:48:06: Checking entry 1 - hearing field: "2025-10-05T23:12"
0|albpetro | 2025-10-06T00:48:06: Parsing date string: 2025-10-05T23:12
0|albpetro | 2025-10-06T00:48:06: Parsed exactly as stored: 2025-10-05T21:12:00.000Z from input: 2025-10-05T23:12
0|albpetro | 2025-10-06T00:48:06: Parsed hearing date: 2025-10-05T21:12:00.000Z
0|albpetro | 2025-10-06T00:48:06:     Window check: hearing=2025-10-05T21:12:00.000Z, now=2025-10-05T22:48:06.185Z, hours_ahead=-1.6, window=≤26h, result=false
0|albpetro | 2025-10-06T00:48:06: Is within notification window: false (hearing at 2025-10-05T21:12:00.000Z is -2 hours from now)
0|albpetro | 2025-10-06T00:48:06: Checking entry 1 appeal - hearing field: "2025-10-05T23:42"
0|albpetro | 2025-10-06T00:48:06: Parsing date string: 2025-10-05T23:42
0|albpetro | 2025-10-06T00:48:06: Parsed exactly as stored: 2025-10-05T21:42:00.000Z from input: 2025-10-05T23:42
0|albpetro | 2025-10-06T00:48:06: Parsed appeal hearing date: 2025-10-05T21:42:00.000Z
0|albpetro | 2025-10-06T00:48:06:     Window check: hearing=2025-10-05T21:42:00.000Z, now=2025-10-05T22:48:06.186Z, hours_ahead=-1.1, window=≤26h, result=false
0|albpetro | 2025-10-06T00:48:06: Appeal hearing is within notification window: false (hearing at 2025-10-05T21:42:00.000Z is -1 hours from now)
0|albpetro | 2025-10-06T00:48:06: Found 0 upcoming hearings
0|albpetro | 2025-10-06T00:48:15: 12:48:15 AM [express] GET /api/auth/user 304 in 5ms :: {"id":"it-system-admin","email":"it.system@alb…
0|albpetro | 2025-10-06T00:48:15: 12:48:15 AM [express] GET /api/data-entries 304 in 13ms :: {"entries":[{"id":2,"paditesi":"aaa","iPad…
0|albpetro | 2025-10-06T00:48:24: 12:48:24 AM [express] GET /api/users 304 in 7ms :: [{"id":"5f93759a-589d-4bf9-8b0f-390d4bbc584e","ema…
0|albpetro | 2025-10-06T00:48:43: 12:48:43 AM [express] POST /api/transfer-cases 200 in 13ms
0|albpetro | 2025-10-06T00:48:56: 12:48:56 AM [express] GET /api/auth/user 304 in 4ms :: {"id":"it-system-admin","email":"it.system@alb…
0|albpetro | 2025-10-06T00:48:56: 12:48:56 AM [express] GET /api/data-entries 304 in 9ms :: {"entries":[{"id":2,"paditesi":"aaa","iPadi…
0|albpetro | 2025-10-06T00:49:08: 12:49:08 AM [express] GET /api/users 304 in 13ms :: [{"id":"5f93759a-589d-4bf9-8b0f-390d4bbc584e","em…
0|albpetro | 2025-10-06T00:49:16: 12:49:16 AM [express] GET /api/auth/user 304 in 4ms :: {"id":"it-system-admin","email":"it.system@alb…
0|albpetro | 2025-10-06T00:49:16: 12:49:16 AM [express] GET /api/auth/logout 302 in 6ms
0|albpetro | 2025-10-06T00:49:17: 12:49:17 AM [express] GET /api/auth/user 401 in 3ms
0|albpetro | 2025-10-06T00:49:35:
0|albpetro | 2025-10-06T00:49:35: ══════════════════════════════════════════════════════════════
0|albpetro | 2025-10-06T00:49:35: 📧 SENDING REAL EMAIL - it.system@albpetrol.al
0|albpetro | 2025-10-06T00:49:35: ══════════════════════════════════════════════════════════════
0|albpetro | 2025-10-06T00:49:35: TO: it.system@albpetrol.al
0|albpetro | 2025-10-06T00:49:35: FROM: it.system@albpetrol.al
0|albpetro | 2025-10-06T00:49:35: SUBJECT: Kodi i Verifikimit - Albpetrol SH.A.
0|albpetro | 2025-10-06T00:49:35: ──────────────────────────────────────────────────────────────
0|albpetro | 2025-10-06T00:49:37: ✅ EMAIL DELIVERED SUCCESSFULLY
0|albpetro | 2025-10-06T00:49:37: ══════════════════════════════════════════════════════════════
0|albpetro | 2025-10-06T00:49:37:
0|albpetro | 2025-10-06T00:49:37: ✅ Two-factor code sent to: it.system@albpetrol.al
0|albpetro | 2025-10-06T00:49:37: 12:49:37 AM [express] POST /api/login 200 in 1660ms :: {"requiresTwoFactor":true,"userId":"it-system-…
0|albpetro | 2025-10-06T00:50:00: 12:50:00 AM [express] POST /api/verify-2fa 200 in 13ms :: {"id":"it-system-admin","email":"it.system@…
0|albpetro | 2025-10-06T00:50:00: 12:50:00 AM [express] GET /api/dashboard/stats 304 in 5ms :: {"totalEntries":2,"todayEntries":0,"acti…
0|albpetro | 2025-10-06T00:50:00: 12:50:00 AM [express] GET /api/dashboard/recent-entries 304 in 4ms :: [{"id":2,"paditesi":"aaa","iPad…
0|albpetro | 2025-10-06T00:50:05: 12:50:05 AM [express] GET /api/users 304 in 7ms :: [{"id":"5f93759a-589d-4bf9-8b0f-390d4bbc584e","ema…
0|albpetro | 2025-10-06T00:50:20: 12:50:20 AM [express] POST /api/transfer-cases 200 in 10ms
0|albpetro | 2025-10-06T00:50:29: 12:50:29 AM [express] GET /api/data-entries 304 in 10ms :: {"entries":[{"id":2,"paditesi":"aaa","iPad…

