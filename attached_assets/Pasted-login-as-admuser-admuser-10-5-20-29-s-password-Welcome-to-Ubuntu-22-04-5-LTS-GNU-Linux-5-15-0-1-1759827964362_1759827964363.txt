login as: admuser
admuser@10.5.20.29's password:
Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 5.15.0-157-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct  7 11:02:30 AM CEST 2025

  System load:  0.0                Processes:              330
  Usage of /:   13.5% of 96.37GB   Users logged in:        1
  Memory usage: 31%                IPv4 address for ens33: 10.5.20.29
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm

New release '24.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


Last login: Tue Oct  7 09:33:12 2025 from 10.5.34.33
admuser@admuser:~$ sudo -i
[sudo] password for admuser:
root@admuser:~# cd /opt/ceshtje-ligjore

echo "=== MOVING /api/force-notifications BEFORE httpServer ==="

# Extract the force-notifications route (lines 1454-1460)
sed -n '1454,1460p' server/routes.ts > /tmp/force_notif.txt

# Remove it from its current location
sed -i '1454,1460d' server/routes.ts

# Now httpServer should be around line 1453, insert the route before it
# First get the line number of httpServer again
httpserver_line=$(grep -n "const httpServer = createServer" server/routes.ts | cut -d: -f1)
echo "httpServer is now at line: $httpserver_line"

# Insert the route 2 lines before httpServer (to have spacing)
insert_line=$((httpserver_line - 2))
sed -i "${insert_line}r /tmp/force_notif.txt" server/routes.ts

echo "✅ Moved /api/force-notifications before httpServer"

# Verify the order
echo ""
finpm run build 2>&1 | grep -A 3 ERRORgrep -c "'/api/force-notifications'" dist/
=== MOVING /api/force-notifications BEFORE httpServer ===
httpServer is now at line: 1448
✅ Moved /api/force-notifications before httpServer

Checking route order:
1400:  app.get('/api/users', isAuthenticated, isAdmin, async (req, res) => {
1411:  app.post('/api/transfer-cases', isAuthenticated, isAdmin, async (req, res) => {
1455:  const httpServer = createServer(app);
1457:  app.post('/api/force-notifications', isAuthenticated, async (req, res) => {


> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.20 building for production...
✓ 2411 modules transformed.
../dist/public/index.html                                         1.09 kB │ gzip:   0.63 kB
../dist/public/assets/Albpetrol.svg_1754604323425-C1lBmiZp.png   93.96 kB
../dist/public/assets/index-D1b5zML-.css                        159.05 kB │ gzip:  25.36 kB
../dist/public/assets/index-No3X9pMA.js                         870.74 kB │ gzip: 255.59 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 3.74s
✘ [ERROR] Expected ")" but found "catch"

    server/routes.ts:1448:6:
      1448 │     } catch (error) {
           │       ~~~~~
           ╵       )

1 error
✘ [ERROR] Expected ")" but found "catch"

    server/routes.ts:1448:6:
      1448 │     } catch (error) {
root@admuser:/opt/ceshtje-ligjore#
