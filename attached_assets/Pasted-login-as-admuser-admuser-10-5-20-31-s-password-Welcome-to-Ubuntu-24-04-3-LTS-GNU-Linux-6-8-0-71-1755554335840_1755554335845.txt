login as: admuser
admuser@10.5.20.31's password:
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.8.0-71-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Mon Aug 18 09:56:26 PM UTC 2025

  System load:  0.03               Processes:              331
  Usage of /:   19.3% of 71.77GB   Users logged in:        1
  Memory usage: 50%                IPv4 address for ens33: 10.5.20.31
  Swap usage:   0%


Expanded Security Maintenance for Applications is not enabled.

10 updates can be applied immediately.
To see these additional updates run: apt list --upgradable

5 additional security updates can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


Last login: Mon Aug 18 21:30:35 2025 from 172.16.1.8
admuser@ceshtjeligjore:~$ sudo -i
[sudo] password for admuser:
root@ceshtjeligjore:~# sudo nano simple_timestamp_fix.sh
root@ceshtjeligjore:~# chmod +x simple_timestamp_fix.sh
./simple_timestamp_fix.sh
================================================
Simple Targeted Fix for Timestamp Issues
================================================
[FIX 1] Making timestamp field optional in schema...
[FIX 2] Adding server-side timestamp conversion...
[FIX 3] Adding better error logging...
[FIX 4] Database and build...

> rest-express@1.0.0 db:push
> drizzle-kit push

No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/ceshtje_ligjore/ceshtje_ligjore/drizzle.config.ts'
Using 'pg' driver for database querying
[✓] Pulling schema from database...
[i] No changes detected
Building application...

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
transforming...
Browserslist: browsers data (caniuse-lite) is 10 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
✓ 90 modules transformed.
x Build failed in 1.29s
error during build:
[vite:esbuild] Transform failed with 1 error:
/opt/ceshtje_ligjore/ceshtje_ligjore/client/src/components/case-entry-form.tsx:70:13: ERROR: Expected ")" but found ":"
file: /opt/ceshtje_ligjore/ceshtje_ligjore/client/src/components/case-entry-form.tsx:70:13

Expected ")" but found ":"
68 |      },
69 |      },
70 |      onSuccess: () => {
   |               ^
71 |        toast({
72 |          title: "Çështja u shtua me sukses",

    at failureErrorWithLog (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:1472:15)
    at /opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:755:50
    at responseCallbacks.<computed> (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at Pipe.onStreamRead (node:internal/stream_base_commons:191:23)
[ERROR] Build failed. Check build.log for details:
file: /opt/ceshtje_ligjore/ceshtje_ligjore/client/src/components/case-entry-form.tsx:70:13

Expected ")" but found ":"
68 |      },
69 |      },
70 |      onSuccess: () => {
   |               ^
71 |        toast({
72 |          title: "Çështja u shtua me sukses",

    at failureErrorWithLog (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:1472:15)
    at /opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:755:50
    at responseCallbacks.<computed> (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at Pipe.onStreamRead (node:internal/stream_base_commons:191:23)
root@ceshtjeligjore:~# # Check service status and logs
systemctl status albpetrol-legal --no-pager
journalctl -u albpetrol-legal -n 10 --no-pager

# Check if there are any build errors
cd /opt/ceshtje_ligjore/ceshtje_ligjore
npm run build
● albpetrol-legal.service - Albpetrol Legal Management System
     Loaded: loaded (/etc/systemd/system/albpetrol-legal.service; enabled; preset: enabled)
     Active: active (running) since Mon 2025-08-18 21:19:51 UTC; 38min ago
   Main PID: 479220 (node)
      Tasks: 11 (limit: 9428)
     Memory: 63.3M (peak: 82.5M)
        CPU: 1.385s
     CGroup: /system.slice/albpetrol-legal.service
             └─479220 /usr/bin/node dist/index.js

Aug 18 21:37:55 ceshtjeligjore albpetrol-legal[479220]: 9:37:55 PM [express]…[{…
Aug 18 21:38:23 ceshtjeligjore albpetrol-legal[479220]: 9:38:23 PM [express]…[{…
Aug 18 21:49:52 ceshtjeligjore albpetrol-legal[479220]: 9:49:52 PM [express]…,"…
Aug 18 21:49:55 ceshtjeligjore albpetrol-legal[479220]: 9:49:55 PM [express]…,"…
Aug 18 21:49:56 ceshtjeligjore albpetrol-legal[479220]: 9:49:56 PM [express]…ti…
Aug 18 21:49:56 ceshtjeligjore albpetrol-legal[479220]: 9:49:56 PM [express] …[]
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express]…,"…
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express]…ti…
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express] …[]
Aug 18 21:50:35 ceshtjeligjore albpetrol-legal[479220]: 9:50:35 PM [express]…[{…
Hint: Some lines were ellipsized, use -l to show in full.
Aug 18 21:37:55 ceshtjeligjore albpetrol-legal[479220]: 9:37:55 PM [express] POST /api/data-entries 400 in 14ms :: {"message":"Validation error","errors":[{…
Aug 18 21:38:23 ceshtjeligjore albpetrol-legal[479220]: 9:38:23 PM [express] POST /api/data-entries 400 in 14ms :: {"message":"Validation error","errors":[{…
Aug 18 21:49:52 ceshtjeligjore albpetrol-legal[479220]: 9:49:52 PM [express] GET /api/auth/user 304 in 3ms :: {"id":"5ac9719a-9b70-492d-a42e-3f1bcd8a5539","…
Aug 18 21:49:55 ceshtjeligjore albpetrol-legal[479220]: 9:49:55 PM [express] GET /api/auth/user 304 in 2ms :: {"id":"5ac9719a-9b70-492d-a42e-3f1bcd8a5539","…
Aug 18 21:49:56 ceshtjeligjore albpetrol-legal[479220]: 9:49:56 PM [express] GET /api/dashboard/stats 200 in 5ms :: {"totalEntries":0,"todayEntries":0,"acti…
Aug 18 21:49:56 ceshtjeligjore albpetrol-legal[479220]: 9:49:56 PM [express] GET /api/dashboard/recent-entries 200 in 3ms :: []
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express] GET /api/auth/user 304 in 3ms :: {"id":"5ac9719a-9b70-492d-a42e-3f1bcd8a5539","…
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express] GET /api/dashboard/stats 304 in 4ms :: {"totalEntries":0,"todayEntries":0,"acti…
Aug 18 21:50:00 ceshtjeligjore albpetrol-legal[479220]: 9:50:00 PM [express] GET /api/dashboard/recent-entries 304 in 9ms :: []
Aug 18 21:50:35 ceshtjeligjore albpetrol-legal[479220]: 9:50:35 PM [express] POST /api/data-entries 400 in 13ms :: {"message":"Validation error","errors":[{…

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
transforming (3) src/main.tsxBrowserslist: browsers data (caniuse-lite) is 10 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
✓ 92 modules transformed.
x Build failed in 1.30s
error during build:
[vite:esbuild] Transform failed with 1 error:
/opt/ceshtje_ligjore/ceshtje_ligjore/client/src/components/case-entry-form.tsx:70:13: ERROR: Expected ")" but found ":"
file: /opt/ceshtje_ligjore/ceshtje_ligjore/client/src/components/case-entry-form.tsx:70:13

Expected ")" but found ":"
68 |      },
69 |      },
70 |      onSuccess: () => {
   |               ^
71 |        toast({
72 |          title: "Çështja u shtua me sukses",

    at failureErrorWithLog (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:1472:15)
    at /opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:755:50
    at responseCallbacks.<computed> (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/opt/ceshtje_ligjore/ceshtje_ligjore/node_modules/vite/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:524:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at Pipe.onStreamRead (node:internal/stream_base_commons:191:23)
root@ceshtjeligjore:/opt/ceshtje_ligjore/ceshtje_ligjore#
