oot@ceshtjeligjore:/opt/ceshtje-ligjore# cd /opt/ceshtje-ligjore

# Export environment variables to the shell
export NODE_ENV=production
export PORT=5000
export DATABASE_URL="postgresql://ceshtje_user:Albpetrol2025@localhost:5432/ceshtje_ligjore"
export SESSION_SECRET="albpetrol_ceshtje_ligjore_secret_2025_production_ready"
export ISSUER_URL="https://replit.com/oidc"

# Verify environment variables are set
echo "DATABASE_URL: $DATABASE_URL"

# Test with exported environment variables
timeout 15s node dist/index.js > server_test3.log 2>&1 &
SERVER_PID=$!
sleep 8

# Test if it works now
curl -I http://localhost:5000/

# Check the output
echo "=== SERVER OUTPUT WITH EXPORTED VARS ==="
cat server_test3.log | head -20

# Kill test server
kill $SERVER_PID 2>/dev/null

echo "=== TESTING WITH EXPORTED ENVIRONMENT VARIABLES ==="
DATABASE_URL: postgresql://ceshtje_user:Albpetrol2025@localhost:5432/ceshtje_ligjore
[1] 14214
[1]+  Exit 1                  timeout 15s node dist/index.js > server_test3.log 2>&1
curl: (7) Failed to connect to localhost port 5000 after 0 ms: Couldn't connect to server
=== SERVER OUTPUT WITH EXPORTED VARS ===

file:///opt/ceshtje-ligjore/node_modules/@neondatabase/serverless/index.mjs:1345
o?t(o):n(u)},"cb"),s=new r(function(o,u){n=o,t=u}).catch(o=>{throw Error.captureStackTrace(
                                                                         ^
ErrorEvent {
  [Symbol(kTarget)]: WebSocket {
    _events: [Object: null prototype] {
      error: [Function: onError] {
        [Symbol(kIsForOnEventAttribute)]: false,
        [Symbol(kListener)]: [Function (anonymous)]
      },
      message: [Function: onMessage] {
        [Symbol(kIsForOnEventAttribute)]: false,
        [Symbol(kListener)]: [Function (anonymous)]
      },
      close: [Function: onClose] {
        [Symbol(kIsForOnEventAttribute)]: false,
        [Symbol(kListener)]: [Function (anonymous)]
      },
      open: [Function: onOpen] {
=== TESTING WITH EXPORTED ENVIRONMENT VARIABLES ===
root@ceshtjeligjore:/opt/ceshtje-ligjore# 

