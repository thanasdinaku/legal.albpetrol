root@admuser:/opt/ceshtje-ligjore/client/src/components# # Build the application
npm run build

# Restart PM2
pm2 restart albpetrol-legal

# Check logs to confirm it's running
pm2 logs albpetrol-legal --lines 20

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.20 building for production...
✓ 2411 modules transformed.
../dist/public/index.html                                         1.09 kB │ gzip:   0.63 kB
../dist/public/assets/Albpetrol.svg_1754604323425-C1lBmiZp.png   93.96 kB
../dist/public/assets/index-D1b5zML-.css                        159.05 kB │ gzip:  25.36 kB
../dist/public/assets/index-C7Z821u7.js                         870.74 kB │ gzip: 255.59 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 3.87s

  dist/index.js  186.5kb

⚡ Done in 8ms
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name               │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼────────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ default     │ 1.0.0   │ fork    │ 36885    │ 0s     │ 4    │ online    │ 0%       │ 20.4mb   │ root     │ disabled │
└────┴────────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
[TAILING] Tailing last 20 lines for [albpetrol-legal] process (change the value with --lines option)
/opt/ceshtje-ligjore/logs/err-0.log last 20 lines:
0|albpetro | 2025-10-04T23:48:26: Error fetching backups: SyntaxError: Unexpected token 'd', "data_entri"... is not valid JSON
0|albpetro | 2025-10-04T23:48:26:     at JSON.parse (<anonymous>)
0|albpetro | 2025-10-04T23:48:26:     at BackupService.getBackups (file:///opt/ceshtje-ligjore/dist/index.js:2907:26)
0|albpetro | 2025-10-04T23:48:26:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|albpetro | 2025-10-04T23:48:26:     at async file:///opt/ceshtje-ligjore/dist/index.js:4134:23
0|albpetro | 2025-10-04T23:48:26: Error getting backups: SyntaxError: Unexpected token 'd', "data_entri"... is not valid JSON
0|albpetro | 2025-10-04T23:48:26:     at JSON.parse (<anonymous>)
0|albpetro | 2025-10-04T23:48:26:     at BackupService.getBackups (file:///opt/ceshtje-ligjore/dist/index.js:2907:26)
0|albpetro | 2025-10-04T23:48:26:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|albpetro | 2025-10-04T23:48:26:     at async file:///opt/ceshtje-ligjore/dist/index.js:4134:23
0|albpetro | 2025-10-05T16:34:01: Error fetching backups: SyntaxError: Unexpected token 'd', "data_entri"... is not valid JSON
0|albpetro | 2025-10-05T16:34:01:     at JSON.parse (<anonymous>)
0|albpetro | 2025-10-05T16:34:01:     at BackupService.getBackups (file:///opt/ceshtje-ligjore/dist/index.js:2907:26)
0|albpetro | 2025-10-05T16:34:01:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|albpetro | 2025-10-05T16:34:01:     at async file:///opt/ceshtje-ligjore/dist/index.js:4134:23
0|albpetro | 2025-10-05T16:34:01: Error getting backups: SyntaxError: Unexpected token 'd', "data_entri"... is not valid JSON
0|albpetro | 2025-10-05T16:34:01:     at JSON.parse (<anonymous>)
0|albpetro | 2025-10-05T16:34:01:     at BackupService.getBackups (file:///opt/ceshtje-ligjore/dist/index.js:2907:26)
0|albpetro | 2025-10-05T16:34:01:     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|albpetro | 2025-10-05T16:34:01:     at async file:///opt/ceshtje-ligjore/dist/index.js:4134:23

/opt/ceshtje-ligjore/logs/out-0.log last 20 lines:
0|albpetro | 2025-10-05T23:13:11: Notification already sent for case 1 - appeal
0|albpetro | 2025-10-05T23:23:11: [2025-10-05T21:23:11.619Z] 🕐 AUTOMATIC CHECK TRIGGERED (every 10 minutes)
0|albpetro | 2025-10-05T23:23:11: [2025-10-05T21:23:11.619Z] === COURT HEARING CHECK STARTED ===
0|albpetro | 2025-10-05T23:23:11: Current time (GMT+1): 05.10.2025, 23:23
0|albpetro | 2025-10-05T23:23:11: Checking hearings within ≤26 hours: up to 06.10.2025, 23:23 [Albania Time]
0|albpetro | 2025-10-05T23:23:11: Checking entry 1 - hearing field: "2025-10-05T23:12"
0|albpetro | 2025-10-05T23:23:11: Parsing date string: 2025-10-05T23:12
0|albpetro | 2025-10-05T23:23:11: Parsed exactly as stored: 2025-10-05T21:12:00.000Z from input: 2025-10-05T23:12
0|albpetro | 2025-10-05T23:23:11: Parsed hearing date: 2025-10-05T21:12:00.000Z
0|albpetro | 2025-10-05T23:23:11:     Window check: hearing=2025-10-05T21:12:00.000Z, now=2025-10-05T21:23:11.629Z, hours_ahead=-0.2, window=≤26h, result=false
0|albpetro | 2025-10-05T23:23:11: Is within notification window: false (hearing at 2025-10-05T21:12:00.000Z is 0 hours from now)
0|albpetro | 2025-10-05T23:23:11: Checking entry 1 appeal - hearing field: "2025-10-05T23:42"
0|albpetro | 2025-10-05T23:23:11: Parsing date string: 2025-10-05T23:42
0|albpetro | 2025-10-05T23:23:11: Parsed exactly as stored: 2025-10-05T21:42:00.000Z from input: 2025-10-05T23:42
0|albpetro | 2025-10-05T23:23:11: Parsed appeal hearing date: 2025-10-05T21:42:00.000Z
0|albpetro | 2025-10-05T23:23:11:     Window check: hearing=2025-10-05T21:42:00.000Z, now=2025-10-05T21:23:11.629Z, hours_ahead=0.3, window=≤26h, result=true
0|albpetro | 2025-10-05T23:23:11: Appeal hearing is within notification window: true (hearing at 2025-10-05T21:42:00.000Z is 0 hours from now)
0|albpetro | 2025-10-05T23:23:11: Added appeal hearing for case 1 to notification queue
0|albpetro | 2025-10-05T23:23:11: Found 1 upcoming hearings
0|albpetro | 2025-10-05T23:23:11: Notification already sent for case 1 - appeal

0|albpetrol-legal  | 2025-10-05T23:27:34: 🚀 CourtHearingScheduler constructor called
0|albpetrol-legal  | 2025-10-05T23:27:34:
0|albpetrol-legal  | 2025-10-05T23:27:34: ══════════════════════════════════════════════════════════════
0|albpetrol-legal  | 2025-10-05T23:27:34: 🕐 SYSTEM TIMEZONE CONFIGURATION - GMT+1 (ALBANIA TIME)
0|albpetrol-legal  | 2025-10-05T23:27:34: ══════════════════════════════════════════════════════════════
0|albpetrol-legal  | 2025-10-05T23:27:34: 🌍 Configured Timezone: Europe/Tirane (GMT+1 - Albania Time)
0|albpetrol-legal  | 2025-10-05T23:27:34: ⏰ Current UTC Time: 2025-10-05T21:27:34.709Z
0|albpetrol-legal  | 2025-10-05T23:27:34: 🇦🇱 Current Albania Time (GMT+1): 05.10.2025, 23:27
0|albpetrol-legal  | 2025-10-05T23:27:34: 📅 Albanian Date Format: 05.10.2025
0|albpetrol-legal  | 2025-10-05T23:27:34: 🕒 Albanian Time Format: 23:27
0|albpetrol-legal  | 2025-10-05T23:27:34: ══════════════════════════════════════════════════════════════
0|albpetrol-legal  | 2025-10-05T23:27:34:
0|albpetrol-legal  | 2025-10-05T23:27:34: 🟢 Starting court hearing notification scheduler...
0|albpetrol-legal  | 2025-10-05T23:27:34: ✅ Scheduler configured: checking every 10 minutes, startup check in 5 seconds
0|albpetrol-legal  | 2025-10-05T23:27:34: 🔧 Initializing database...
0|albpetrol-legal  | 2025-10-05T23:27:34: 🔑 Generated scrypt password hash for admin user
0|albpetrol-legal  | 2025-10-05T23:27:34: ✅ Admin user already exists
0|albpetrol-legal  | 2025-10-05T23:27:34: ✅ Admin password already in correct scrypt format
0|albpetrol-legal  | 2025-10-05T23:27:34: ✅ Database initialization completed
0|albpetrol-legal  | 2025-10-05T23:27:34: Initializing court hearing notification scheduler...
0|albpetrol-legal  | 2025-10-05T23:27:34: ⚠️ Scheduler already running, skipping duplicate start
0|albpetrol-legal  | 2025-10-05T23:27:34: Scheduler instance created, starting automatic notifications...
0|albpetrol-legal  | 2025-10-05T23:27:34: 11:27:34 PM [express] serving on port 5000
0|albpetrol-legal  | 2025-10-05T23:27:39: [2025-10-05T21:27:39.720Z] 🚀 STARTUP CHECK TRIGGERED (5 seconds after start)
0|albpetrol-legal  | 2025-10-05T23:27:39: [2025-10-05T21:27:39.721Z] === COURT HEARING CHECK STARTED ===
0|albpetrol-legal  | 2025-10-05T23:27:39: Current time (GMT+1): 05.10.2025, 23:27
0|albpetrol-legal  | 2025-10-05T23:27:39: Checking hearings within ≤26 hours: up to 06.10.2025, 23:27 [Albania Time]
0|albpetrol-legal  | 2025-10-05T23:27:39: Checking entry 1 - hearing field: "2025-10-05T23:12"
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsing date string: 2025-10-05T23:12
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsed exactly as stored: 2025-10-05T21:12:00.000Z from input: 2025-10-05T23:12
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsed hearing date: 2025-10-05T21:12:00.000Z
0|albpetrol-legal  | 2025-10-05T23:27:39:     Window check: hearing=2025-10-05T21:12:00.000Z, now=2025-10-05T21:27:39.726Z, hours_ahead=-0.3, window=≤26h, result=false
0|albpetrol-legal  | 2025-10-05T23:27:39: Is within notification window: false (hearing at 2025-10-05T21:12:00.000Z is 0 hours from now)
0|albpetrol-legal  | 2025-10-05T23:27:39: Checking entry 1 appeal - hearing field: "2025-10-05T23:42"
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsing date string: 2025-10-05T23:42
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsed exactly as stored: 2025-10-05T21:42:00.000Z from input: 2025-10-05T23:42
0|albpetrol-legal  | 2025-10-05T23:27:39: Parsed appeal hearing date: 2025-10-05T21:42:00.000Z
0|albpetrol-legal  | 2025-10-05T23:27:39:     Window check: hearing=2025-10-05T21:42:00.000Z, now=2025-10-05T21:27:39.726Z, hours_ahead=0.2, window=≤26h, result=true
0|albpetrol-legal  | 2025-10-05T23:27:39: Appeal hearing is within notification window: true (hearing at 2025-10-05T21:42:00.000Z is 0 hours from now)
0|albpetrol-legal  | 2025-10-05T23:27:39: Added appeal hearing for case 1 to notification queue
0|albpetrol-legal  | 2025-10-05T23:27:39: Found 1 upcoming hearings
0|albpetrol-legal  | 2025-10-05T23:27:39: Notification already sent for case 1 - appeal
