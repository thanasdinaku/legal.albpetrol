root@admuser:/opt/ceshtje-ligjore# pm2 delete albpetrol-legal && DATABASE_URL="postgresql://albpetrol_user:SecurePass2025@localhost:5432/albpetrol_legal_db" pm2 start dist/index.js --name albpetrol-legal --update-env && pm2 save
[PM2] Applying action deleteProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2] Starting /opt/ceshtje-ligjore/dist/index.js in fork_mode (1 instance)
[PM2] Done.
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 0    │ online    │ 0%       │ 13.9mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2] Saving current process list...
[PM2] Successfully saved in /root/.pm2/dump.pm2
root@admuser:/opt/ceshtje-ligjore# pm2 logs albpetrol-legal --lines 20
[TAILING] Tailing last 20 lines for [albpetrol-legal] process (change the value with --lines option)
/root/.pm2/logs/albpetrol-legal-error.log last 20 lines:
0|albpetro |     at __init (file:///opt/ceshtje-ligjore/dist/index.js:10:56)
0|albpetro |     at file:///opt/ceshtje-ligjore/dist/index.js:2006:1
0|albpetro |     at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
0|albpetro |     at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
0|albpetro | Error: DATABASE_URL must be set. Did you forget to provision a database?
0|albpetro |     at server/db.ts (file:///opt/ceshtje-ligjore/dist/index.js:265:13)
0|albpetro |     at __init (file:///opt/ceshtje-ligjore/dist/index.js:10:56)
0|albpetro |     at server/storage.ts (file:///opt/ceshtje-ligjore/dist/index.js:1134:5)
0|albpetro |     at __init (file:///opt/ceshtje-ligjore/dist/index.js:10:56)
0|albpetro |     at file:///opt/ceshtje-ligjore/dist/index.js:2006:1
0|albpetro |     at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
0|albpetro |     at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
0|albpetro | Error: DATABASE_URL must be set. Did you forget to provision a database?
0|albpetro |     at server/db.ts (file:///opt/ceshtje-ligjore/dist/index.js:265:13)
0|albpetro |     at __init (file:///opt/ceshtje-ligjore/dist/index.js:10:56)
0|albpetro |     at server/storage.ts (file:///opt/ceshtje-ligjore/dist/index.js:1134:5)
0|albpetro |     at __init (file:///opt/ceshtje-ligjore/dist/index.js:10:56)
0|albpetro |     at file:///opt/ceshtje-ligjore/dist/index.js:2006:1
0|albpetro |     at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
0|albpetro |     at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)

/root/.pm2/logs/albpetrol-legal-out.log last 20 lines:
0|albpetro | ⚠️ Scheduler already running, skipping duplicate start
0|albpetro | Scheduler instance created, starting automatic notifications...
0|albpetro | 1:37:53 AM [express] serving on port 5000
0|albpetro | [2025-10-06T23:37:58.623Z] 🚀 STARTUP CHECK TRIGGERED (5 seconds after start)
0|albpetro | [2025-10-06T23:37:58.625Z] === COURT HEARING CHECK STARTED ===
0|albpetro | Current time (GMT+1): 07.10.2025, 01:37
0|albpetro | Checking hearings within ≤26 hours: up to 08.10.2025, 01:37 [Albania Time]
0|albpetro | Checking entry 1 - hearing field: "2025-10-05T23:12"
0|albpetro | Parsing date string: 2025-10-05T23:12
0|albpetro | Parsed exactly as stored: 2025-10-05T21:12:00.000Z from input: 2025-10-05T23:12
0|albpetro | Parsed hearing date: 2025-10-05T21:12:00.000Z
0|albpetro |     Window check: hearing=2025-10-05T21:12:00.000Z, now=2025-10-06T23:37:58.629Z, hours_ahead=-26.4, window=≤26h, result=false
0|albpetro | Is within notification window: false (hearing at 2025-10-05T21:12:00.000Z is -26 hours from now)
0|albpetro | Checking entry 1 appeal - hearing field: "2025-10-05T23:42"
0|albpetro | Parsing date string: 2025-10-05T23:42
0|albpetro | Parsed exactly as stored: 2025-10-05T21:42:00.000Z from input: 2025-10-05T23:42
0|albpetro | Parsed appeal hearing date: 2025-10-05T21:42:00.000Z
0|albpetro |     Window check: hearing=2025-10-05T21:42:00.000Z, now=2025-10-06T23:37:58.629Z, hours_ahead=-25.9, window=≤26h, result=false
0|albpetro | Appeal hearing is within notification window: false (hearing at 2025-10-05T21:42:00.000Z is -26 hours from now)
0|albpetro | Found 0 upcoming hearings
