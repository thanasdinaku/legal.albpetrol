root@ceshtjeligjore:/opt/ceshtje-ligjore# # Quick fix - replace the server with a simple working version
cd /opt/ceshtje-ligjore

# Stop PM2
pm2 stop albpetrol-legal

# Create a simple working server file
cat > dist/index.js << 'SIMPLE_AUTH_SERVER_EOF'
import express from 'express';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const app = express();
const PORT = process.env.PORT || 5000;

console.log('Starting Albpetrol Legal System server...');

// Simple session storage
const sessions = new Map();

echo "🔒 Password: Admin2025!"etrol.al"nv.NODE_ENV || 'development'}`);u, 01 Jan
[PM2] Applying action stopProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 2    │ stopped   │ 0%       │ 0b       │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2] Applying action restartProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 2    │ online    │ 0%       │ 18.6mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 2    │ online    │ 0%       │ 56.1mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[TAILING] Tailing last 5 lines for [albpetrol-legal] process (change the value with --lines option)
/root/.pm2/logs/albpetrol-legal-error-0.log last 5 lines:
0|albpetro | 2025-08-20T10:59:08: ReferenceError: require is not defined in ES module scope, you can use import instead
0|albpetro | 2025-08-20T10:59:08: This file is being treated as an ES module because it has a '.js' file extension and '/opt/ceshtje-ligjore/package.json' contains "type": "module". To treat it as a CommonJS script, rename it to use the '.cjs' file extension.
0|albpetro | 2025-08-20T10:59:08:     at file:///opt/ceshtje-ligjore/dist/index.js:1:17
0|albpetro | 2025-08-20T10:59:08:     at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
0|albpetro | 2025-08-20T10:59:08:     at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)

/root/.pm2/logs/albpetrol-legal-out-0.log last 5 lines:
0|albpetro | 2025-08-20T11:03:03: Health check requested
0|albpetro | 2025-08-20T11:08:50: Starting Albpetrol Legal System server...
0|albpetro | 2025-08-20T11:08:50: ✅ Albpetrol Legal System running on port 5000
0|albpetro | 2025-08-20T11:08:50: Server accessible at http://0.0.0.0:5000
0|albpetro | 2025-08-20T11:08:50: Environment: production

