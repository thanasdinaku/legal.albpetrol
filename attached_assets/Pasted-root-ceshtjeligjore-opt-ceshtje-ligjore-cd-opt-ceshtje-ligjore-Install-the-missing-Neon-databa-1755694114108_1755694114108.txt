root@ceshtjeligjore:/opt/ceshtje-ligjore# cd /opt/ceshtje-ligjore

# Install the missing Neon database package
npm install @neondatabase/serverless --save

# Install all production dependencies 
npm install --production

# Restart PM2
pm2 restart albpetrol-legal

# Check if it's now working
sleep 5
pm2 logs albpetrol-legal --lines 5 --nostream
ss -tlnp | grep 5000
curl -I http://localhost:5000

added 2 packages, and audited 657 packages in 3s

80 packages are looking for funding
  run `npm fund` for details

1 high severity vulnerability

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
npm warn config production Use `--omit=dev` instead.

up to date, audited 657 packages in 2s

80 packages are looking for funding
  run `npm fund` for details

1 high severity vulnerability

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [albpetrol-legal](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 7    │ online    │ 0%       │ 19.1mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[TAILING] Tailing last 5 lines for [albpetrol-legal] process (change the value with --lines option)
/var/log/pm2/albpetrol-legal-out-0.log last 5 lines:
0|albpetro | 2025-08-20T12:33:57: 🔐 Test Login: it.system@albpetrol.al / Admin2025!
0|albpetro | 2025-08-20T12:33:57: 📧 2FA codes will be displayed in console for: it.system@albpetrol.al
0|albpetro | 2025-08-20T12:33:57: ✨ Features: Professional UI with Albpetrol logo, 2FA, Real Dashboard matching Replit exactly
0|albpetro | 2025-08-20T12:34:22: Login attempt: it.system@albpetrol.al
0|albpetro | 2025-08-20T12:34:22: 2FA code generated for it.system@albpetrol.al: 416375

/var/log/pm2/albpetrol-legal-error-0.log last 5 lines:
0|albpetro | 2025-08-20T12:48:19:     at ModuleLoader.resolve (node:internal/modules/esm/loader:574:38)
0|albpetro | 2025-08-20T12:48:19:     at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:236:38)
0|albpetro | 2025-08-20T12:48:19:     at ModuleJob._link (node:internal/modules/esm/module_job:130:49) {
0|albpetro | 2025-08-20T12:48:19:   code: 'ERR_MODULE_NOT_FOUND'
0|albpetro | 2025-08-20T12:48:19: }

curl: (7) Failed to connect to localhost port 5000 after 0 ms: Couldn't connect to server
root@ceshtjeligjore:/opt/ceshtje-ligjore# 
