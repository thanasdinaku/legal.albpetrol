root@ceshtjeligjore:/opt/ceshtje-ligjore# cd /opt/ceshtje-ligjore

# Stop PM2
pm2 stop all
pm2 delete all

# Create a simple working server that definitely works
mkdir -p dist/public

# Install express if missing
npm install express --save

# Create a basic working server
cat > dist/index.js << 'EOF'
import express from 'express';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

const app = express();
const PORT = 5000;

curl -I http://localhost:5000s &.."ol-legal-out.log',og',${PORT}`);' });
[PM2] Applying action stopProcessId on app [all](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 81   │ stopped   │ 0%       │ 0b       │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[PM2] Applying action deleteProcessId on app [all](ids: [ 0 ])
[PM2] [albpetrol-legal](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘

up to date, audited 657 packages in 1s

80 packages are looking for funding
  run `npm fund` for details

1 high severity vulnerability

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
Testing direct connection...
[2] 21763
🚀 Starting Albpetrol Legal System...
✅ Albpetrol Legal System running on port 5000
🌐 Access at: http://0.0.0.0:5000
LISTEN 0      511          0.0.0.0:5000       0.0.0.0:*    users:(("node",pid=21765,fd=20))                                                 
[PM2][WARN] Applications albpetrol-legal not running, starting...
[PM2] App [albpetrol-legal] launched (1 instances)
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 0    │ online    │ 0%       │ 19.3mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[2]-  Terminated              timeout 10s node dist/index.js
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ albpetrol-legal    │ fork     │ 0    │ online    │ 0%       │ 58.4mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
LISTEN 0      511          0.0.0.0:5000       0.0.0.0:*    users:(("node /opt/cesht",pid=21787,fd=19))                                      
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: text/html; charset=utf-8
Content-Length: 341
ETag: W/"155-miAEyk0SkFA2cRf6jr/yrdAF83g"
Date: Wed, 20 Aug 2025 12:52:30 GMT
Connection: keep-alive
Keep-Alive: timeout=5

HTTP/1.1 200 OK
Server: nginx/1.24.0 (Ubuntu)
Date: Wed, 20 Aug 2025 12:52:30 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 341
Connection: keep-alive
X-Powered-By: Express
ETag: W/"155-OjXqpcRpCIjseGoZ/nut3SiTPPE"

root@ceshtjeligjore:/opt/ceshtje-ligjore# 
